行番号,ソースコード
1,SAMPLE01 順次ファイルコンバート,,OTHER,
2,++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++,,OTHER,
3,順次ファイルコンバート,,OTHER,
4,1つのファイルをある条件に従って３ファイルに出力する。,,OTHER,
5,++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++,,OTHER,
6,----*----1----*----2----*----3----*----4----*----5----*----6----*----7,,OTHER,
7,000000* SAMPLE01 LEVEL=1 DATE=95.10.01,,OTHER,
8,000100****************************************************************,,OTHER,
9,000200* *,,OTHER,
10,000300* サブシステム名：資材所要量計画 *,,OTHER,
11,000400* *,,OTHER,
12,000500* モジュール名 ：順次ファイルコンバート *,,OTHER,
13,000600* *,,OTHER,
14,000700* モジュールＩＤ：SAMPLE01 *,,OTHER,
15,000800* *,,OTHER,
16,000900* 機能概要 ：1つのファイルをある条件に従って３ファイルに *,,OTHER,
17,001000*　　　　　　　　：出力する。 *,,OTHER,
18,001100* *,,OTHER,
19,001200* 作成者 ：山田太郎 *,,OTHER,
20,001300* 作成日 ：1995.10.01 *,,OTHER,
21,001400* 変更履歴 ：1996.08.01 山田　ＸＸＸを追加 *,,OTHER,
22,001500* *,,OTHER,
23,001600****************************************************************,,OTHER,
24,001700 IDENTIFICATION DIVISION.,,IDENTIFICATION,
25,001800 PROGRAM-ID. SAMPLE01.,,IDENTIFICATION,
26,001900*,,IDENTIFICATION,
27,002000 ENVIRONMENT DIVISION.,,ENVIRONMENT,
28,002100 INPUT-OUTPUT SECTION.,,ENVIRONMENT,INPUT-OUTPUT
29,002200 FILE-CONTROL.,,ENVIRONMENT,
30,002300　　　SELECT IN01-FILE ASSIGN IN01.,,ENVIRONMENT,
31,002400　　　SELECT OT01-FILE ASSIGN OT01.,,ENVIRONMENT,
32,002400　　　SELECT OT02-FILE ASSIGN OT02,,ENVIRONMENT,
33,002400　　　SELECT OT03-FILE ASSIGN OT03.,,ENVIRONMENT,
34,002500/,,ENVIRONMENT,
35,002600 DATA DIVISION.,,DATA,
36,002700 FILE SECTION.,,DATA,FILE
37,002800 FD IN01-FILE,,DATA,
38,002900　　　　　BLOCK CONTAINS 0 RECORDS.,,DATA,
39,003000 01 I1-REC.,,DATA,
40,003100　　　COPY AAA001 REPLACING ==()== BY ==I1-==.,,DATA,
41,003200*,,DATA,
42,003300 FD OT01-FILE.,,DATA,
43,003400 01 O1-REC.,,DATA,
44,003500　　　 COPY BBB001 REPLACING ==()== BY ==O1-==.,,DATA,
45,003200*,,DATA,
46,003300 FD OT02-FILE.,,DATA,
47,003400 01 O2-REC.,,DATA,
48,003500　　　 COPY BBB001 REPLACING ==()== BY ==O2-==.,,DATA,
49,003200*,,DATA,
50,003300 FD OT03-FILE.,,DATA,
51,003400 01 O3-REC.,,DATA,
52,003500　　　 COPY BBB001 REPLACING ==()== BY ==O3-==.,,DATA,
53,003600/,,DATA,
54,002400 WORKING-STORAGE SECTION.,,DATA,WORKING-STORAGE
55,002500*,,DATA,
56,003900*----ワークエリア----------------------------------------------*,,DATA,
57,004000 01 WRK-AREA.,,DATA,
58,004100　　　03 CAN-AREA.,,DATA,
59,"004200　　　　　05 CAN-PGMID PIC X(08) VALUE ""SAMPLE01"".",,DATA,
60,004300　　　03 CTR-AREA.,,DATA,
61,004400　　　　　05 CTR-I1 PIC S9(09) PACKED-DECIMAL.,,DATA,
62,004500　　　　　05 CTR-O1 PIC S9(09) PACKED-DECIMAL.,,DATA,
63,004500　　　　　05 CTR-O2 PIC S9(09) PACKED-DECIMAL.,,DATA,
64,004500　　　　　05 CTR-O3 PIC S9(09) PACKED-DECIMAL.,,DATA,
65,004100　　　03 KEY-AREA.,,DATA,
66,004200　　　　　05 KEY-NEW PIC X(01).,,DATA,
67,002700　　　03 MSG-AREA.,,DATA,
68,002800　　　　　COPY DISPMSG.,,DATA,
69,004600*,,DATA,
70,004700*----初期化領域------------------------------------------------*,,DATA,
71,004800 01 INI-O1-REC.,,DATA,
72,004900　　　 COPY BBB001 REPLACING ==()== BY ==INI-O1-==.,,DATA,
73,004600*,,DATA,
74,004700*----共通領域--------------------------------------------------*,,DATA,
75,004800 01 W1-REC.,,DATA,
76,004900　　　 COPY BBB001 REPLACING ==()== BY ==W1-==.,,DATA,
77,006900/,,DATA,
78,007000PROCEDURE DIVISION.,,PROCEDURE,
79,007100****************************************************************,,PROCEDURE,
80,007200* SAMPLE01 (0.0) *,,PROCEDURE,
81,007300****************************************************************,,PROCEDURE,
82,007400 00-SAMPLE01 SECTION.,,PROCEDURE,00-SAMPLE01
83,007100*,,PROCEDURE,
84,007500　　　PERFORM 10-INIT.,,PROCEDURE,
85,007700　　　PERFORM 20-MAIN,,PROCEDURE,
86,008000　　　　　UNTIL KEY-NEW = HIGH-VALUE.,,PROCEDURE,
87,008100　　　PERFORM 30-END.,,PROCEDURE,
88,008200*,,PROCEDURE,
89,008300 00-SAMPLE01-EXIT.,,PROCEDURE,
90,008400　　　EXIT PROGRAM.,,PROCEDURE,
91,008500/***************************************************************,,PROCEDURE,
92,008600* ＜初期処理＞ (1.0) *,,PROCEDURE,
93,008700* 領域の初期クリア、入出力ファイルをオープンする。 *,,PROCEDURE,
94,008800* *,,PROCEDURE,
95,008900****************************************************************,,PROCEDURE,
96,009000 10-INIT SECTION.,,PROCEDURE,10-INIT
97,009100*,,PROCEDURE,
98,007200*----出力ファイルの初期化--------------------------------------*,,PROCEDURE,
99,007300 MOVE SPACE TO INI-O1-REC.,,PROCEDURE,
100,007400 INITIALIZE INI-O1-REC.,,PROCEDURE,
101,007900*,,PROCEDURE,
102,008000*----ワークエリアの初期化--------------------------------------*,,PROCEDURE,
103,008100 MOVE LOW-VALUE TO KEY-NEW.,,PROCEDURE,
104,008200 MOVE ZERO TO CTR-AREA.,,PROCEDURE,
105,007500*,,PROCEDURE,
106,007600*----ファイルＯＰＥＮ------------------------------------------*,,PROCEDURE,
107,007700 OPEN INPUT IN01-FILE.,,PROCEDURE,
108,007800 OPEN OUTPUT OT01-FILE,,PROCEDURE,
109,007800　　　　　　　　　 OT02-FILE,,PROCEDURE,
110,007800　　　　　　　　　 OT03-FILE.,,PROCEDURE,
111,007500*,,PROCEDURE,
112,008220*----入力ファイルのＲＥＡＤ------------------------------------*,,PROCEDURE,
113,008230 PERFORM 11-READ.,,PROCEDURE,
114,,,PROCEDURE,
115,012100*,,PROCEDURE,
116,012200 10-INIT-EXIT.,,PROCEDURE,
117,012300 EXIT.,,PROCEDURE,
118,012400****************************************************************,,PROCEDURE,
119,012500* ＜ＲＥＡＤ処理＞ (1.1) *,,PROCEDURE,
120,012600* 入力ファイルをＲＥＡＤする。 *,,PROCEDURE,
121,012700* *,,PROCEDURE,
122,012800****************************************************************,,PROCEDURE,
123,012900 11-READ SECTION.,,PROCEDURE,11-READ
124,013000*,,PROCEDURE,
125,009400　　　READ IN01-FILE,DBアクセス:IN01-FILE,PROCEDURE,
126,009500　　　　AT END,DBアクセス:IN01-FILE,PROCEDURE,
127,009600　　　　　MOVE HIGH-VALUE TO KEY-NEW,DBアクセス:IN01-FILE,PROCEDURE,
128,009700　　　　NOT AT END,DBアクセス:IN01-FILE,PROCEDURE,
129,009800　　　　　COMPUTE CTR-I1 = CTR-I1 + 1,DBアクセス:IN01-FILE,PROCEDURE,
130,009900　　　END-READ.,DBアクセス:IN01-FILE,PROCEDURE,
131,014000*,,PROCEDURE,
132,014100 11-READ-EXIT.,,PROCEDURE,
133,014200 EXIT.,,PROCEDURE,
134,014300****************************************************************,,PROCEDURE,
135,014400* ＜主処理＞ (2.0) *,,PROCEDURE,
136,014500* レコードを編集してＷＲＩＴＥする。 *,,PROCEDURE,
137,014600* *,,PROCEDURE,
138,014700****************************************************************,,PROCEDURE,
139,014800 20-MAIN SECTION.,,PROCEDURE,20-MAIN
140,014900*,,PROCEDURE,
141,015000*----出力ファイルの初期化--------------------------------------*,,PROCEDURE,
142,015100 MOVE INI-O1-REC TO W1-REC.,,PROCEDURE,
143,015200*,,PROCEDURE,
144,015300*----出力ファイルの編集----------------------------------------*,,PROCEDURE,
145,015400 MOVE I1-AA0001 TO W1-BB0001.,,PROCEDURE,
146,015500 MOVE I1-AA0002 TO W1-BB0002.,,PROCEDURE,
147,015600 MOVE I1-AA0003 TO W1-BB0003.,,PROCEDURE,
148,015700 MOVE I1-AA0004 TO W1-BB0004.,,PROCEDURE,
149,015800 MOVE I1-AA0005 TO W1-BB0005.,,PROCEDURE,
150,015900*,,PROCEDURE,
151,016000*----振り分け＆出力ファイルのＷＲＩＴＥ------------------------*,,PROCEDURE,
152,016100　　　EVALUATE I1-AA0001,,PROCEDURE,
153,016200　　　　　WHEN 1,,PROCEDURE,
154,016300　　　　　WHEN 2,,PROCEDURE,
155,"016400　　　　　　　MOVE W1-REC TO O2-REC *1,2の時",,PROCEDURE,
156,016500　　　　　　　PERFORM 22-WRITE,,PROCEDURE,
157,016700　　　　　WHEN 3,,PROCEDURE,
158,016400　　　　　　　MOVE W1-REC TO O3-REC *3の時,,PROCEDURE,
159,016500　　　　　　　PERFORM 23-WRITE,,PROCEDURE,
160,017100　　　　　WHEN OTHER,,PROCEDURE,
161,"016400　　　　　　　MOVE W1-REC TO O1-REC *1,2,3以外の時",,PROCEDURE,
162,016500　　　　　　　PERFORM 21-WRITE,,PROCEDURE,
163,017500　　　END-EVALUATE.,,PROCEDURE,
164,017600*,,PROCEDURE,
165,017610*----入力ファイルのＲＥＡＤ------------------------------------*,,PROCEDURE,
166,017620 PERFORM 11-READ.,,PROCEDURE,
167,017630*,,PROCEDURE,
168,017700 20-MAIN-EXIT.,,PROCEDURE,
169,017800 EXIT.,,PROCEDURE,
170,017900****************************************************************,,PROCEDURE,
171,018000* ＜終了処理＞ (3.0) *,,PROCEDURE,
172,018100* 入出力ファイルをＣＬＯＳＥする。 *,,PROCEDURE,
173,018200* *,,PROCEDURE,
174,018300****************************************************************,,PROCEDURE,
175,018400 30-END SECTION.,,PROCEDURE,30-END
176,018500*,,PROCEDURE,
177,014400*----ファイルＣＬＯＳＥ----------------------------------------*,,PROCEDURE,
178,014500 CLOSE IN01-FILE,,PROCEDURE,
179,014600　　　　 OT01-FILE,,PROCEDURE,
180,014600　　　　 OT02-FILE,,PROCEDURE,
181,014600　　　　 OT03-FILE.,,PROCEDURE,
182,020100*,,PROCEDURE,
183,020200* 件数のコンソール表示,,PROCEDURE,
184,020300 MOVE SPACE TO MSG-REC.,,PROCEDURE,
185,020400 MOVE CAN-PGMID TO MSG-PROGRAM-ID.,,PROCEDURE,
186,020500 MOVE 3 TO MSG-TBL-NUM.,,PROCEDURE,
187,"020600 MOVE ""XXXXX"" TO MSG-MESSAGE-B(1).",,PROCEDURE,
188,020700 MOVE CTR-I1 TO MSG-REC-CTR(1).,,PROCEDURE,
189,"020800 MOVE ""XXXXX"" TO MSG-MESSAGE-B(2).",,PROCEDURE,
190,020900 MOVE CTR-O1 TO MSG-REC-CTR(2).,,PROCEDURE,
191,"021000 MOVE ""XXXXX"" TO MSG-MESSAGE-B(3).",,PROCEDURE,
192,021100 MOVE CTR-O2 TO MSG-REC-CTR(3).,,PROCEDURE,
193,"021200 CALL ""AAAAMSG"" USING MSG-AREA.",,PROCEDURE,
194,021300*,,PROCEDURE,
195,021400 30-END-EXIT.,,PROCEDURE,
196,021500 EXIT.,,PROCEDURE,
197,012500/***************************************************************,,PROCEDURE,
198,012600* ＜ＷＲＩＴＥ処理＞ (2.1) *,,PROCEDURE,
199,012700* 出力ファイル１へのＷＲＩＴＥする。 *,,PROCEDURE,
200,012800* *,,PROCEDURE,
201,012900****************************************************************,,PROCEDURE,
202,013000 21-WRITE SECTION.,,PROCEDURE,21-WRITE
203,013100*,,PROCEDURE,
204,013200 WRITE O1-REC.,,PROCEDURE,
205,017000 COMPUTE CTR-O1 = CTR-O1 + 1.,,PROCEDURE,
206,013400*,,PROCEDURE,
207,013500 21-WRITE-EXIT.,,PROCEDURE,
208,013600 EXIT.,,PROCEDURE,
209,012500****************************************************************,,PROCEDURE,
210,012600* ＜ＷＲＩＴＥ処理＞ (2.2) *,,PROCEDURE,
211,012700* 出力ファイル２へのＷＲＩＴＥする。 *,,PROCEDURE,
212,012800* *,,PROCEDURE,
213,012900****************************************************************,,PROCEDURE,
214,013000 22-WRITE SECTION.,,PROCEDURE,22-WRITE
215,013100*,,PROCEDURE,
216,013200 WRITE O2-REC.,,PROCEDURE,
217,017000 COMPUTE CTR-O2 = CTR-O2 + 1.,,PROCEDURE,
218,013400*,,PROCEDURE,
219,013500 22-WRITE-EXIT.,,PROCEDURE,
220,013600 EXIT. 012500****************************************************************,,PROCEDURE,
221,012600* ＜ＷＲＩＴＥ処理＞ (2.3) *,,PROCEDURE,
222,012700* 出力ファイル３へのＷＲＩＴＥする。 *,,PROCEDURE,
223,012800* *,,PROCEDURE,
224,012900****************************************************************,,PROCEDURE,
225,013000 23-WRITE SECTION.,,PROCEDURE,23-WRITE
226,013100*,,PROCEDURE,
227,013200 WRITE O3-REC.,,PROCEDURE,
228,017000 COMPUTE CTR-O3 = CTR-O3 + 1.,,PROCEDURE,
229,013400*,,PROCEDURE,
230,013500 23-WRITE-EXIT.,,PROCEDURE,
231,013600 EXIT.,,PROCEDURE,
